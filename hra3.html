<!DOCTYPE html>
<html lang="cs">
<head>
<meta charset="UTF-8">
<title>Geometry Dash ‚Äì s c√≠lem</title>
<style>
  body {
    margin: 0;
    background: #000;
  }
  canvas {
    display: block;
    margin: auto;
    background: #111;
  }
</style>
</head>
<body>

<canvas id="game" width="800" height="400"></canvas>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

const groundY = 330;
let speed = 4;
let gravity = 0.8;
let jumpForce = -14;

let gameOver = false;
let win = false;

// d√©lka levelu
const levelLength = 3000;
let distance = 0;

const player = {
  x: 100,
  y: groundY,
  size: 30,
  velY: 0,
  onGround: true
};

let obstacles = [];
let frame = 0;

// ovl√°d√°n√≠
document.addEventListener("keydown", e => {
  if (e.code === "Space" && player.onGround) jump();
});
canvas.addEventListener("click", jump);

function jump() {
  if (!gameOver && !win && player.onGround) {
    player.velY = jumpForce;
    player.onGround = false;
  }
}

function spawnObstacle() {
  obstacles.push({
    x: canvas.width,
    width: 30,
    height: 40
  });
}

function update() {
  if (gameOver || win) return;

  frame++;
  distance += speed;

  if (frame % 90 === 0 && distance < levelLength - 500) {
    spawnObstacle();
  }

  // fyzika hr√°ƒçe
  player.velY += gravity;
  player.y += player.velY;

  if (player.y >= groundY) {
    player.y = groundY;
    player.velY = 0;
    player.onGround = true;
  }

  // pohyb p≈ôek√°≈æek
  obstacles.forEach(o => o.x -= speed);

  // kolize s p≈ôek√°≈ækou
  obstacles.forEach(o => {
    if (
      player.x < o.x + o.width &&
      player.x + player.size > o.x &&
      player.y < groundY + o.height &&
      player.y + player.size > groundY
    ) {
      gameOver = true;
    }
  });

  // kolize s c√≠lem
  if (distance >= levelLength) {
    win = true;
  }

  obstacles = obstacles.filter(o => o.x + o.width > 0);
}

function draw() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);

  // zem
  ctx.fillStyle = "#333";
  ctx.fillRect(0, groundY + player.size, canvas.width, 5);

  // hr√°ƒç
  ctx.fillStyle = "#00ffff";
  ctx.fillRect(player.x, player.y, player.size, player.size);

  // p≈ôek√°≈æky
  ctx.fillStyle = "red";
  obstacles.forEach(o => {
    ctx.beginPath();
    ctx.moveTo(o.x, groundY + player.size);
    ctx.lineTo(o.x + o.width / 2, groundY);
    ctx.lineTo(o.x + o.width, groundY + player.size);
    ctx.closePath();
    ctx.fill();
  });

  // C√çL
  const goalX = canvas.width - 50;
  if (distance >= levelLength - 200) {
    ctx.fillStyle = "lime";
    ctx.fillRect(goalX, groundY - 60, 20, 90);
    ctx.font = "16px Arial";
    ctx.fillText("C√çL", goalX - 5, groundY - 70);
  }

  // HUD
  ctx.fillStyle = "white";
  ctx.font = "18px Arial";
  ctx.fillText(
    `Postup: ${Math.min(100, Math.floor((distance / levelLength) * 100))}%`,
    10, 25
  );

  if (gameOver) {
    ctx.font = "40px Arial";
    ctx.fillText("GAME OVER", 280, 200);
  }

  if (win) {
    ctx.font = "40px Arial";
    ctx.fillText("YOU WIN üéâ", 300, 200);
  }
}

function loop() {
  update();
  draw();
  requestAnimationFrame(loop);
}

loop();
</script>

</body>
</html>
